<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>C64 PETSCII + ASCII (0x00–0x7F) Demo</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
      height: 100%;
      width: 100%;
    }
    canvas {
      display: block;
      image-rendering: pixelated;
    }
  </style>
</head>
<body>
  <canvas id="fontCanvas"></canvas>
  <script>
    // ─────────────────────────────────────────────────────────────────────────────
    // 1) Prepare a 256-entry PETSCII table, defaulting all entries to blank:
    // ─────────────────────────────────────────────────────────────────────────────

    function blankGlyph() {
      return [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00];
    }

    const font8x8_petscii = new Array(256).fill(null).map(() => blankGlyph());

    // ─────────────────────────────────────────────────────────────────────────────
    // 2) Define a few “graphics” codes (0x30–0x3F) as before (blocks, dithers, triangles):
    // ─────────────────────────────────────────────────────────────────────────────

    // Full block (0x30)
    font8x8_petscii[0x30] = [
      0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF
    ];
    // 50% horizontal stripes (0x31)
    font8x8_petscii[0x31] = [
      0xFF,0x00,0xFF,0x00,0xFF,0x00,0xFF,0x00
    ];
    // 50% vertical stripes (0x32)
    font8x8_petscii[0x32] = [
      0xAA,0xAA,0xAA,0xAA,0xAA,0xAA,0xAA,0xAA
    ];
    // 25% dots (0x33)
    font8x8_petscii[0x33] = [
      0x88,0x22,0x08,0x22,0x88,0x22,0x08,0x22
    ];
    // Checkerboard (0x34)
    font8x8_petscii[0x34] = [
      0x55,0xAA,0x55,0xAA,0x55,0xAA,0x55,0xAA
    ];
    // Diagonal (0x36)
    font8x8_petscii[0x36] = [
      0x80,0x40,0x20,0x10,0x08,0x04,0x02,0x01
    ];
    // Reverse diagonal (0x37)
    font8x8_petscii[0x37] = [
      0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80
    ];
    // Top half block (0x38)
    font8x8_petscii[0x38] = [
      0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00
    ];
    // Bottom half block (0x39)
    font8x8_petscii[0x39] = [
      0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF
    ];
    // Left half block (0x3A)
    font8x8_petscii[0x3A] = [
      0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xF0
    ];
    // Right half block (0x3B)
    font8x8_petscii[0x3B] = [
      0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F
    ];
    // Center 2×2 (0x3C)
    font8x8_petscii[0x3C] = [
      0x00,0x00,0x18,0x18,0x18,0x18,0x00,0x00
    ];
    // Upper-left triangle (0x3D)
    font8x8_petscii[0x3D] = [
      0x80,0xC0,0xE0,0xF0,0xF8,0xFC,0xFE,0xFF
    ];
    // Upper-right triangle (0x3E)
    font8x8_petscii[0x3E] = [
      0x01,0x03,0x07,0x0F,0x1F,0x3F,0x7F,0xFF
    ];
    // Lower-left triangle (0x3F)
    font8x8_petscii[0x3F] = [
      0xFF,0xFE,0xFC,0xF8,0xF0,0xE0,0xC0,0x80
    ];

    // ─────────────────────────────────────────────────────────────────────────────
    // 3) NOW PASTE YOUR “ASCII 0x00–0x7F” ARRAY IN PLACE of the old 0x20–0x7F lines:
    // ─────────────────────────────────────────────────────────────────────────────

    // Instead of assigning one code at a time, we can literally copy-paste your entire block.
    // (Be sure this is exactly what you provided, in the correct order from 0x00 to 0x7F.)

    font8x8_petscii[0x00] = [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x01] = [0x7E,0x81,0xA5,0x81,0xBD,0x99,0x81,0x7E];
    font8x8_petscii[0x02] = [0x7E,0xFF,0xDB,0xFF,0xC3,0xE7,0xFF,0x7E];
    font8x8_petscii[0x03] = [0x6C,0xFE,0xFE,0xFE,0x7C,0x38,0x10,0x00];
    font8x8_petscii[0x04] = [0x10,0x38,0x7C,0xFE,0x7C,0x38,0x10,0x00];
    font8x8_petscii[0x05] = [0x38,0x7C,0x38,0xFE,0xFE,0xD6,0x10,0x38];
    font8x8_petscii[0x06] = [0x10,0x38,0x7C,0xFE,0x7C,0x38,0x10,0x38];
    font8x8_petscii[0x07] = [0x00,0x18,0x3C,0x3C,0x18,0x00,0x18,0x00];
    font8x8_petscii[0x08] = [0xFF,0xC3,0x99,0xBD,0xA5,0xC3,0xFF,0xFF];
    font8x8_petscii[0x09] = [0x00,0x00,0x18,0x3C,0x3C,0x18,0x00,0x00];
    font8x8_petscii[0x0A] = [0xFF,0xFF,0xE7,0xC3,0xC3,0xE7,0xFF,0xFF];
    font8x8_petscii[0x0B] = [0x0F,0x07,0x0F,0x7D,0xCC,0xCC,0xCC,0x78];
    font8x8_petscii[0x0C] = [0x3C,0x66,0x66,0x3C,0x18,0x7E,0x18,0x00];
    font8x8_petscii[0x0D] = [0xFF,0xFF,0xE7,0xC3,0xC3,0xE7,0xFF,0xFF];
    font8x8_petscii[0x0E] = [0x0E,0x0C,0x0C,0x7C,0xCC,0xCC,0x7F,0x03];
    font8x8_petscii[0x0F] = [0xFC,0xCC,0xCC,0xCF,0xC3,0xC3,0xFE,0xC0];
    font8x8_petscii[0x10] = [0x6C,0xFE,0xFE,0xFE,0x7C,0x38,0x10,0x00];
    font8x8_petscii[0x11] = [0x10,0x38,0x7C,0xFE,0x7C,0x38,0x10,0x00];
    font8x8_petscii[0x12] = [0x7C,0xFE,0x92,0x92,0x92,0xFE,0x7C,0x00];
    font8x8_petscii[0x13] = [0x38,0x7C,0xFE,0xFE,0xFE,0x7C,0x38,0x00];
    font8x8_petscii[0x14] = [0x18,0x3C,0x7E,0x18,0x18,0x7E,0x3C,0x18];
    font8x8_petscii[0x15] = [0x66,0x66,0x66,0x00,0x00,0x66,0x66,0x66];
    font8x8_petscii[0x16] = [0xFF,0xFF,0xFF,0x00,0x00,0xFF,0xFF,0xFF];
    font8x8_petscii[0x17] = [0xF0,0xF0,0xF0,0x00,0x00,0xF0,0xF0,0xF0];
    font8x8_petscii[0x18] = [0xCC,0xCC,0x00,0x00,0x00,0xCC,0xCC,0x00];
    font8x8_petscii[0x19] = [0x0F,0x0F,0x00,0x00,0x00,0x0F,0x0F,0x00];
    font8x8_petscii[0x1A] = [0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00];
    font8x8_petscii[0x1B] = [0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x1C] = [0x0F,0x0F,0x0F,0xF0,0xF0,0xF0,0x00,0x00];
    font8x8_petscii[0x1D] = [0x33,0x33,0x33,0xCC,0xCC,0xCC,0x00,0x00];
    font8x8_petscii[0x1E] = [0x3F,0x3F,0x3F,0xC0,0xC0,0xC0,0x00,0x00];
    font8x8_petscii[0x1F] = [0xFF,0xFF,0xFF,0xC0,0xC0,0xC0,0x00,0x00];
    font8x8_petscii[0x20] = [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x21] = [0x18,0x3C,0x3C,0x18,0x18,0x00,0x18,0x00];
    font8x8_petscii[0x22] = [0x6C,0x6C,0x48,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x23] = [0x6C,0x6C,0xFE,0x6C,0xFE,0x6C,0x6C,0x00];
    font8x8_petscii[0x24] = [0x18,0x3E,0x60,0x3C,0x06,0x7C,0x18,0x00];
    font8x8_petscii[0x25] = [0x00,0xC6,0xCC,0x18,0x30,0x66,0xC6,0x00];
    font8x8_petscii[0x26] = [0x38,0x6C,0x38,0x76,0xDC,0xCC,0x76,0x00];
    font8x8_petscii[0x27] = [0x30,0x30,0x60,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x28] = [0x0C,0x18,0x30,0x30,0x30,0x18,0x0C,0x00];
    font8x8_petscii[0x29] = [0x30,0x18,0x0C,0x0C,0x0C,0x18,0x30,0x00];
    font8x8_petscii[0x2A] = [0x00,0x66,0x3C,0xFF,0x3C,0x66,0x00,0x00];
    font8x8_petscii[0x2B] = [0x00,0x18,0x18,0x7E,0x18,0x18,0x00,0x00];
    font8x8_petscii[0x2C] = [0x00,0x00,0x00,0x00,0x18,0x18,0x30,0x00];
    font8x8_petscii[0x2D] = [0x00,0x00,0x00,0x7E,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x2E] = [0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00];
    font8x8_petscii[0x2F] = [0x06,0x0C,0x18,0x30,0x60,0xC0,0x80,0x00];
    font8x8_petscii[0x30] = [0x7C,0xC6,0xCE,0xD6,0xE6,0xC6,0x7C,0x00];
    font8x8_petscii[0x31] = [0x18,0x38,0x18,0x18,0x18,0x18,0x7E,0x00];
    font8x8_petscii[0x32] = [0x7C,0xC6,0x06,0x1C,0x30,0x66,0xFE,0x00];
    font8x8_petscii[0x33] = [0x7C,0xC6,0x06,0x3C,0x06,0xC6,0x7C,0x00];
    font8x8_petscii[0x34] = [0x1C,0x3C,0x6C,0xCC,0xFE,0x0C,0x1E,0x00];
    font8x8_petscii[0x35] = [0xFE,0xC0,0xF8,0x0C,0x06,0xC6,0x7C,0x00];
    font8x8_petscii[0x36] = [0x3C,0x60,0xC0,0xF8,0xCC,0xCC,0x78,0x00];
    font8x8_petscii[0x37] = [0xFE,0xC6,0x0C,0x18,0x18,0x18,0x18,0x00];
    font8x8_petscii[0x38] = [0x7C,0xC6,0xC6,0x7C,0xC6,0xC6,0x7C,0x00];
    font8x8_petscii[0x39] = [0x7C,0xC6,0xC6,0x7E,0x06,0x0C,0x78,0x00];
    font8x8_petscii[0x3A] = [0x00,0x18,0x18,0x00,0x00,0x18,0x18,0x00];
    font8x8_petscii[0x3B] = [0x00,0x18,0x18,0x00,0x00,0x18,0x18,0x30];
    font8x8_petscii[0x3C] = [0x0E,0x1C,0x38,0x70,0x38,0x1C,0x0E,0x00];
    font8x8_petscii[0x3D] = [0x00,0x00,0x7E,0x00,0x00,0x7E,0x00,0x00];
    font8x8_petscii[0x3E] = [0x70,0x38,0x1C,0x0E,0x1C,0x38,0x70,0x00];
    font8x8_petscii[0x3F] = [0x7C,0xC6,0x0E,0x1C,0x18,0x00,0x18,0x00];
    font8x8_petscii[0x40] = [0x7C,0xC6,0xDE,0xDE,0xDE,0xC0,0x78,0x00];
    font8x8_petscii[0x41] = [0x38,0x6C,0xC6,0xFE,0xC6,0xC6,0xC6,0x00];
    font8x8_petscii[0x42] = [0xFC,0x66,0x66,0x7C,0x66,0x66,0xFC,0x00];
    font8x8_petscii[0x43] = [0x3C,0x66,0xC0,0xC0,0xC0,0x66,0x3C,0x00];
    font8x8_petscii[0x44] = [0xF8,0x6C,0x66,0x66,0x66,0x6C,0xF8,0x00];
    font8x8_petscii[0x45] = [0xFE,0x62,0x68,0x78,0x68,0x62,0xFE,0x00];
    font8x8_petscii[0x46] = [0xFE,0x62,0x68,0x78,0x68,0x60,0xF0,0x00];
    font8x8_petscii[0x47] = [0x3C,0x66,0xC0,0xC0,0xCE,0x66,0x3A,0x00];
    font8x8_petscii[0x48] = [0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0x00];
    font8x8_petscii[0x49] = [0x3C,0x18,0x18,0x18,0x18,0x18,0x3C,0x00];
    font8x8_petscii[0x4A] = [0x1E,0x0C,0x0C,0x0C,0xCC,0xCC,0x78,0x00];
    font8x8_petscii[0x4B] = [0xE6,0x66,0x6C,0x78,0x6C,0x66,0xE6,0x00];
    font8x8_petscii[0x4C] = [0xF0,0x60,0x60,0x60,0x62,0x66,0xFE,0x00];
    font8x8_petscii[0x4D] = [0xC6,0xEE,0xFE,0xFE,0xD6,0xC6,0xC6,0x00];
    font8x8_petscii[0x4E] = [0xC6,0xE6,0xF6,0xDE,0xCE,0xC6,0xC6,0x00];
    font8x8_petscii[0x4F] = [0x38,0x6C,0xC6,0xC6,0xC6,0x6C,0x38,0x00];
    font8x8_petscii[0x50] = [0xFC,0x66,0x66,0x7C,0x60,0x60,0xF0,0x00];
    font8x8_petscii[0x51] = [0x38,0x6C,0xC6,0xC6,0xDA,0x6C,0x36,0x00];
    font8x8_petscii[0x52] = [0xFC,0x66,0x66,0x7C,0x6C,0x66,0xE6,0x00];
    font8x8_petscii[0x53] = [0x7C,0xC6,0x60,0x38,0x0C,0xC6,0x7C,0x00];
    font8x8_petscii[0x54] = [0xFE,0xB4,0x18,0x18,0x18,0x18,0x3C,0x00];
    font8x8_petscii[0x55] = [0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00];
    font8x8_petscii[0x56] = [0xC6,0xC6,0xC6,0xC6,0x6C,0x38,0x10,0x00];
    font8x8_petscii[0x57] = [0xC6,0xC6,0xD6,0xFE,0xFE,0xEE,0xC6,0x00];
    font8x8_petscii[0x58] = [0xC6,0xC6,0x6C,0x38,0x6C,0xC6,0xC6,0x00];
    font8x8_petscii[0x59] = [0xC6,0xC6,0xC6,0x6C,0x38,0x10,0x10,0x00];
    font8x8_petscii[0x5A] = [0xFE,0xC6,0x8C,0x18,0x32,0x66,0xFE,0x00];
    font8x8_petscii[0x5B] = [0x3C,0x30,0x30,0x30,0x30,0x30,0x3C,0x00];
    font8x8_petscii[0x5C] = [0xC0,0x60,0x30,0x18,0x0C,0x06,0x02,0x00];
    font8x8_petscii[0x5D] = [0x3C,0x0C,0x0C,0x0C,0x0C,0x0C,0x3C,0x00];
    font8x8_petscii[0x5E] = [0x10,0x38,0x6C,0xC6,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x5F] = [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF];
    font8x8_petscii[0x60] = [0x30,0x18,0x0C,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x61] = [0x00,0x00,0x7C,0x06,0x7E,0xC6,0x7E,0x00];
    font8x8_petscii[0x62] = [0xE0,0x60,0x7C,0x66,0x66,0x66,0xDC,0x00];
    font8x8_petscii[0x63] = [0x00,0x00,0x7C,0xC6,0xC0,0xC6,0x7C,0x00];
    font8x8_petscii[0x64] = [0x1C,0x0C,0x7C,0xCC,0xCC,0xCC,0x76,0x00];
    font8x8_petscii[0x65] = [0x00,0x00,0x7C,0xC6,0xFE,0xC0,0x7C,0x00];
    font8x8_petscii[0x66] = [0x3C,0x66,0x60,0xF8,0x60,0x60,0xF0,0x00];
    font8x8_petscii[0x67] = [0x00,0x00,0x76,0xCC,0xCC,0x7C,0x0C,0xF8];
    font8x8_petscii[0x68] = [0xE0,0x60,0x6C,0x76,0x66,0x66,0xE6,0x00];
    font8x8_petscii[0x69] = [0x18,0x00,0x38,0x18,0x18,0x18,0x3C,0x00];
    font8x8_petscii[0x6A] = [0x0C,0x00,0x1C,0x0C,0x0C,0xCC,0xCC,0x78];
    font8x8_petscii[0x6B] = [0xE0,0x60,0x66,0x6C,0x78,0x6C,0xE6,0x00];
    font8x8_petscii[0x6C] = [0x38,0x18,0x18,0x18,0x18,0x18,0x3C,0x00];
    font8x8_petscii[0x6D] = [0x00,0x00,0xEC,0xFE,0xD6,0xD6,0xC6,0x00];
    font8x8_petscii[0x6E] = [0x00,0x00,0xDC,0x66,0x66,0x66,0x66,0x00];
    font8x8_petscii[0x6F] = [0x00,0x00,0x7C,0xC6,0xC6,0xC6,0x7C,0x00];
    font8x8_petscii[0x70] = [0x00,0x00,0xDC,0x66,0x66,0x7C,0x60,0xF0];
    font8x8_petscii[0x71] = [0x00,0x00,0x76,0xCC,0xCC,0x7C,0x0C,0x1E];
    font8x8_petscii[0x72] = [0x00,0x00,0xDC,0x76,0x66,0x60,0xF0,0x00];
    font8x8_petscii[0x73] = [0x00,0x00,0x7E,0xC0,0x7C,0x06,0xFC,0x00];
    font8x8_petscii[0x74] = [0x30,0x30,0xFC,0x30,0x30,0x36,0x1C,0x00];
    font8x8_petscii[0x75] = [0x00,0x00,0xCC,0xCC,0xCC,0xCC,0x76,0x00];
    font8x8_petscii[0x76] = [0x00,0x00,0xC6,0xC6,0x6C,0x38,0x10,0x00];
    font8x8_petscii[0x77] = [0x00,0x00,0xC6,0xD6,0xFE,0xFE,0x6C,0x00];
    font8x8_petscii[0x78] = [0x00,0x00,0xC6,0x6C,0x38,0x6C,0xC6,0x00];
    font8x8_petscii[0x79] = [0x00,0x00,0xC6,0xC6,0xC6,0x7E,0x06,0xFC];
    font8x8_petscii[0x7A] = [0x00,0x00,0xFE,0x4C,0x18,0x32,0xFE,0x00];
    font8x8_petscii[0x7B] = [0x0E,0x18,0x18,0x70,0x18,0x18,0x0E,0x00];
    font8x8_petscii[0x7C] = [0x18,0x18,0x18,0x00,0x18,0x18,0x18,0x00];
    font8x8_petscii[0x7D] = [0x70,0x18,0x18,0x0E,0x18,0x18,0x70,0x00];
    font8x8_petscii[0x7E] = [0x76,0xDC,0x00,0x00,0x00,0x00,0x00,0x00];
    font8x8_petscii[0x7F] = [0x10,0x38,0x54,0x92,0x10,0x10,0x10,0x00];

    // ─────────────────────────────────────────────────────────────────────────────
    // 4) DRAWING ROUTINES & FULL-SCREEN GRID (unchanged from before)
    // ─────────────────────────────────────────────────────────────────────────────

    const canvas = document.getElementById('fontCanvas');
    const ctx    = canvas.getContext('2d');
    const bgColor   = '#000';
    const fontColor = '#0F0';

    function getCode(ch) {
      if (typeof ch === 'string') {
        return ch.charCodeAt(0) & 0xFF;
      }
      return ch & 0xFF;
    }

    function drawChar(ctx, ch, x, y, scale = 1) {
      const code = getCode(ch);
      const glyph = font8x8_petscii[code] || blankGlyph();
      for (let row = 0; row < 8; row++) {
        const rowByte = glyph[row];
        for (let bit = 0; bit < 8; bit++) {
          if (rowByte & (1 << (7 - bit))) {
            ctx.fillRect(
              x + bit * scale,
              y + row * scale,
              scale, scale
            );
          }
        }
      }
    }

    function redrawAll() {
      const W = window.innerWidth;
      const H = window.innerHeight;
      canvas.width  = W;
      canvas.height = H;

      // Clear background
      ctx.fillStyle = bgColor;
      ctx.fillRect(0, 0, W, H);

      const letterSpacing = 1;
      let chosenScale = 1;

      // Find the largest integer “scale” so all 256 chars fit:
      for (let s = Math.floor(Math.min(W / 8, H / 8)); s >= 1; s--) {
        const cellW = 8 * s + letterSpacing;
        const maxCols = Math.floor(W / cellW);
        if (maxCols < 1) continue;
        const rowsNeeded = Math.ceil(256 / maxCols);
        const totalH = rowsNeeded * (8 * s + letterSpacing);
        if (totalH <= H) {
          chosenScale = s;
          break;
        }
      }

      ctx.fillStyle = fontColor;
      const cellW = 8 * chosenScale + letterSpacing;
      const cellH = 8 * chosenScale + letterSpacing;
      const maxCols = Math.floor(W / cellW);

      for (let code = 0; code < 256; code++) {
        const idx = code;
        const col = idx % maxCols;
        const row = Math.floor(idx / maxCols);
        const x = col * cellW;
        const y = row * cellH;
        drawChar(ctx, code, x, y, chosenScale);
      }
    }

    window.addEventListener('load', redrawAll);
    window.addEventListener('resize', () => {
      window.requestAnimationFrame(redrawAll);
    });
  </script>
</body>
</html>